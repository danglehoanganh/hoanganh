<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ti·ªán √≠ch M√£ h√≥a</title>
  <link rel="stylesheet" href="/static/css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <header>
      <h1>üîê Ti·ªán √≠ch M√£ h√≥a</h1>
      <p class="subtitle">Qu·∫£n l√Ω to√†n b·ªô quy tr√¨nh: T·∫°o kh√≥a, m√£ h√≥a, chia file v√† gi·∫£i m√£ ngay tr√™n giao di·ªán.</p>
    </header>

    <section class="status">
      <h2>Tr·∫°ng th√°i hi·ªán t·∫°i</h2>
      <div class="cards">
        <div class="card {{ 'done' if statuses.keys else 'pending' }}">
          <span class="icon">üîë</span>
          <p>{{ 'Kh√≥a RSA s·∫µn s√†ng' if statuses.keys else 'Ch∆∞a t·∫°o kh√≥a RSA' }}</p>
        </div>
        <div class="card {{ 'done' if statuses.assignment else 'pending' }}">
          <span class="icon">üìÑ</span>
          <p>{{ 'File b√†i t·∫≠p ƒë√£ t·∫°o' if statuses.assignment else 'Ch∆∞a c√≥ file b√†i t·∫≠p' }}</p>
        </div>
        <div class="card {{ 'done' if statuses.parts else 'pending' }}">
          <span class="icon">üîí</span>
          <p>{{ 'ƒê√£ m√£ h√≥a & chia file' if statuses.parts else 'Ch∆∞a m√£ h√≥a/chia file' }}</p>
        </div>
        <div class="card {{ 'done' if statuses.received else 'pending' }}">
          <span class="icon">üì•</span>
          <p>{{ 'File ƒë√£ gi·∫£i m√£ & gh√©p' if statuses.received else 'Ch∆∞a gi·∫£i m√£/gh√©p file' }}</p>
        </div>
      </div>
    </section>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="flash">
          {% for msg in messages %}
            <p>{{ msg }}</p>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <section class="actions">
      <h2>Thao t√°c</h2>
      <form method="post">
        <button name="action" value="generate_keys">T·∫°o kh√≥a RSA</button>
        <button name="action" value="create_assignment">T·∫°o file b√†i t·∫≠p</button>
        <button name="action" value="encrypt_split">M√£ h√≥a & Chia file</button>
        <button name="action" value="decrypt_merge">Gi·∫£i m√£ & Gh√©p file</button>
      </form>
    </section>

    {% if output %}
    <section class="output">
      <h2>K·∫øt qu·∫£ Console</h2>
      <pre>{{ output }}</pre>
    </section>
    {% endif %}

    {% if file_content %}
    <section class="file-preview">
      <h2>N·ªôi dung File g·ªëc (assignment.txt)</h2>
      <pre>{{ file_content }}</pre>
    </section>
    {% endif %}

    {% if received_content %}
    <section class="file-preview">
      <h2>N·ªôi dung File nh·∫≠n ƒë∆∞·ª£c (assignment_received.txt)</h2>
      <pre>{{ received_content }}</pre>
    </section>
    {% endif %}

    <footer>
      <p>&copy; 2025 Crypto Utility</p>
    </footer>
  </div>
</body>
</html>